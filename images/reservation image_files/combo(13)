YUI.add("hermes-template-filter-bar-neutered",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeYourPhotosClick" data-action="set" data-value="1" data-text="',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n						<li role="menuitem" data-track="searchFilterScopeYourContactsPhotosClick" data-action="set" data-value="2" data-text="',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function d(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeContactPhotosClick" data-action="set" data-value="3" data-text="',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.personModel,i==null||i===!1?i:i.nsid),typeof i===c?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function v(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeGroupPhotosClick" data-action="set" data-value="4" data-text="',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.groupModel,i==null||i===!1?i:i.id),typeof i===c?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n					",r}function m(e,t){var r="",i,s;return r+='\n		<li role="menuitem">\n			<div class="filter-cc-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+':" data-labeltoggled="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-cc-menu ui-dropdown ui-dropdown-closed ui-unselectable-text">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterLicenseAll" data-action="set" data-value="all" data-text="',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCOnly" data-action="set" data-value="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CC_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCCommericialUse" data-action="set" data-value="cc-comm" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.COMM_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCModifyAdaptBuild" data-action="set" data-value="cc-deriv" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.DERIV_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c="function",h=this;s+='<div class="filter-bar-content">\n\n	<ul class="filter-menu" role="menubar">\n		<li role="menuitem">\n			<div class="filter-sort-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="ui-dropdown ui-dropdown-closed ui-unselectable-text filter-sort-menu">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterSortRelevanceClick" data-action="set" data-value="relevance" data-text="',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l
((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortRecentClick" data-action="set" data-value="date-posted-desc" data-text="',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortInterestingClick" data-action="set" data-value="interestingness-desc" data-text="',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n				</ul>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-search-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="search-scope-menu ui-dropdown ui-dropdown-closed ui-unselectable-text ui-dropdown-ellipsis">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterScopeEveryoneClick" data-action="set" data-value="0" data-text="',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</li>\n\n					",u=n["if"].call(t,(o=t.viewer,o==null||o===!1?o:o.signedIn),{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.showUserOption,{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.groupModel,{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+='\n\n					<li role="menuitem" data-track="searchFilterScopeUsersClick" data-action="set" data-value="5" data-text="',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterScopeGroupsClick" data-action="set" data-value="6" data-text="',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",a={hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-license-search",a):f.call(t,"isFlipped",t.flippers,"enable-license-search",a));if(u||u===0)s+=u;return s+='\n		<li role="menuitem" class="filter-bar-right">\n			<a href="/search/advanced/',(u=n.advancedSearchQueryStr)?u=u.call(t,{hash:{},data:i}):(u=t.advancedSearchQueryStr,u=typeof u===c?u.apply(t):u),s+=l(u)+'">',a={hash:{intlName:"filter-bar.ADVANCED_SEARCH"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+"</a>\n		</li>\n	</ul>\n\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/filter-bar-neutered",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("filter-bar-neutered-view",function(e){var t;t={css:{sortMenu:".filter-sort-menu",sortLabel:".filter-sort-label",searchScopeMenu:".search-scope-menu",searchLabel:".filter-search-label",ccLabel:".filter-cc-label",ccMenu:".filter-cc-menu"}},e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.searchId=e.searchId,this.apiParams={},this.elementStates=this.setElementStates(e),this},subviewConfig:{},loadState:function(){var t=this,n,r,i=t.appContext.getViewer();return this.searchId?n=this.appContext.getModel("search-photos-models",this.searchId).then(function(n){var r=n.getValue("apiParams"),i,s=null,o=null;return t.searchModel=n,r.group_id?(i={},e.TypeValidator.matches.nsid(r.group_id)?i.id=r.group_id:i.pathAlias=r.group_id,s=t.appContext.getModel("group-pool-models",i)):s=e.Promise.resolve(),r.user_id?(i={},e.TypeValidator.matches.nsid(r.user_id)?i.id=r.user_id:i.pathAlias=r.user_id,o=t.appContext.getModel("person-models",i)):o=e.Promise.resolve(),e.Promise.all([s,o]).then(function(e){e[0]&&(t.groupModel=e[0]),e[1]&&(t.personModel=e[1])})}):n=e.Promise.resolve(),i.signedIn?r=t.appContext.getModel("person-preferences-models",i.nsid).then(function(e){t.personPreferencesModel=e}):r=e.Promise.resolve(),e.Promise.all([n,r]).then(function(){t.searchModel?t.apiParams=t.searchModel.getValue("apiParams"):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)})},buildContainer:function(){var e="";return this.searchModel&&(e=this.generateAdvancedSearchQuery(this.searchModel.getValue("apiParams"))),this.setContainerHTML(this.templates("filter-bar-neutered")({elements:this.elementStates,advancedSearchQueryStr:e,viewer:this.appContext.getViewer(),showUserOption:this.personModel&&this.personModel.getValue("nsid")!==this.appContext.getViewer().nsid,personModel:this.personModel&&this.personModel.toJSON(),groupModel:this.groupModel&&this.groupModel.toJSON(),flippers:this.appContext.flipper.toJSON()})),this},activate:function(){var n=this,r=this.appContext.getViewer(),i;return this.filterViews={},this.elementStates.searchScope&&(i=this.getSearchScopeState(this.apiParams,r,this.personModel),this.filterViews.searchLabel=this.createLabelButton(t.css.searchLabel),this.filterViews.searchScope=this.createSimpleDropdown(t.css.searchScopeMenu,i),this.registerEventHandler(this.filterViews.searchScope.on("selected",function(t){var r=e.clone(n.apiParams),i="/search/?";delete r.user_id,delete r.group_id,delete r.contacts;switch(t.clicked.value){case"1":r.user_id=n.appContext.getViewer().nsid;break;case"2":r.contacts="all";break;case"3":r.user_id=t.clicked.itemEl.getData("nsid");break;case"4":r.group_id=t.clicked.itemEl.getData("nsid");break;case"5":i="/search/people/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r));break;case"6":i="/search/groups/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r))}e.SearchHelper.addParamDefaults(r,n.personPreferencesModel),n.navigate(i+e.QueryString.stringify(r))})),this.bindOpenEvent(this.filterViews.searchScope)),this.elementStates.sort&&(this.filterViews.sortLabel=this.createLabelButton(t.css.sortLabel),i=this.apiParams[e.SearchHelper.API.sort],this.filterViews.sort=this.createSimpleDropdown(t.css.sortMenu,i),this.bindSelectedEvent(this.filterViews.sort,e.SearchHelper.API.sort),this.bindOpenEvent(this.filterViews.sort)),this.elementStates.license&&(this.filterViews.ccLabel=this.createLabelButton(t.css.ccLabel),i=this.determineLicenseForUI(this.apiParams[e.SearchHelper.API.license]||"all"),this.filterViews.creativeCommons=new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t.css.ccMenu),selected:i,hasDialogArrow:!0,useCheckMarks:!0,multiSelect:!1,multiSelectSub:!0,selectParent:!0,minimumSelected:1,shouldCreateShim:!1,autoSizeMenu:!1}),this.bindSelectedEvent(this.filterViews.creativeCommons,e.SearchHelper.API.license),this.bindOpenEvent(this.filterViews.creativeCommons)),n},getSearchScopeState:function(e,t,n){var r=0;return e.user_id&&e.group_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:t.signedIn&&e.group_id&&e.contacts?r=2:e.user_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:e.contacts?r=2:e.group_id&&(r=4),r},determineLicenseForAPI:function(t){var n,r=t.indexOf("all")>=0,i=t.indexOf("cc")>=0,s=t.indexOf("cc-comm")>=0,o=t.indexOf("cc-deriv")>=0;return r?n=e.SearchHelper.LICENSE_TYPE.all:i&&s&&o?n=e.SearchHelper.LICENSE_TYPE.commderiv:i&&s?n=e.SearchHelper.LICENSE_TYPE.comm:i&&o?n=e.SearchHelper.LICENSE_TYPE.deriv:i&&(n=e.SearchHelper.LICENSE_TYPE.cc),n},determineLicenseForUI:function(t){var n;switch(t){case e.SearchHelper.LICENSE_TYPE.commderiv:n=["cc","cc-comm","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.comm:n=["cc","cc-comm"];break;case e.SearchHelper.LICENSE_TYPE.deriv:n=["cc","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.cc:n=["cc"];break;default:n=["all"]}return n},classicNavigate:function(t){window.location=e.url(t)},createSimpleDropdown:function(t,n){return new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t),selected:n,useCheckMarks:!0,shouldCreateShim:!1,autoSizeMenu:!1})},createLabelButton:function(t){return new e.Views.ToggleButton({appContext:this.appContext,container:this.get("container").one(t)})},bindSelectedEvent:function(t,n){var r=this;this.registerEventHandler(t.on("selected",function(t){var i=r.apiParams,s={};n==="license"?s[n]=r.determineLicenseForAPI(t.selections):s[n]=t.clicked.value,i=e.merge(i,s),e.SearchHelper.addParamDefaults(i,r.personPreferencesModel),!t.data||!t.data.track?r.appContext.warn("No data-track attribute found on clicked element. Not beaconing."):e.rapidTracker.beacon(r.name,t.data.track),r.navigate("/search/?"+e.QueryString.stringify(i))}))},navigate:function(e){e&&(this.fire("navigating"),this.appContext.flapp.navigate(e))},
bindOpenEvent:function(t){var n=this;this.registerEventHandler(t.on("open",function(t){n.openDropdown&&n.openDropdown.close(),n.openDropdown=t.target,n.registerEventHandler(e.one("body").once("click",function(){n.openDropdown&&n.openDropdown.close()}))})),this.registerEventHandler(t.on("close",function(e){n.openDropdown=null}))},setElementStates:function(e){var t={searchScope:!0,sort:!0,license:this.appContext.flipper.isFlipped("enable-license-search")};return t},generateAdvancedSearchQuery:function(t){var n=e.SearchHelper.mapAPIParamsToAdvancedSearchQuery(t);return t.q&&(n.q=t.q),"?"+e.QueryString.stringify(n)},destructor:function(){var e;for(e in this.filterViews)this.filterViews[e].destroy()}})},"@VERSION@",{requires:["flickrui-css","dropdown","togglebutton","flickr-view","flickr-promise","person-models","group-pool-models","search-photos-models","search-helper","hermes-template-filter-bar-neutered","filter-bar-neutered-css","url"],langBundles:["filter-bar"]});
YUI.add("hermes-lang-filter-bar",function(e,t){e.Intl.add("hermes/filter-bar","en-US",{EVERYONE:["Everyone's Photos"],YOUR_PHOTOS:["Your Photos"],CONTACTS_PHOTOS:["Your Contacts' Photos"],USER_PHOTOS:["${name}","'s Photos"],GROUP_PHOTOS:["Photos in ","${name}"],PEOPLE:["People"],GROUPS:["Groups"],USER_PHOTOS_IN_GROUP:["${name}","'s Photos in ","${group}"],YOUR_PHOTOS_IN_GROUP:["Your Photos in ","${group}"],CONTACTS_PHOTOS_IN_GROUP:["Your Contacts' Photos in ","${group}"],YOUR_FAVORITES:["Your Favorites"],MORE:["More"],LESS:["Less"],PHOTOS_VIDEOS:["Photos & Videos"],ONLY_PHOTOS:["Only Photos"],ONLY_VIDEOS:["Only Videos"],ALL_TIME:["All Time"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],FROM:["From"],TO:["To"],MONTH_CHARS:["mm"],DAY_CHARS:["dd"],YEAR_CHARS:["yyyy"],DATE_INVALID:["Date invalid"],DONE:["Done"],DATE:["Date"],LICENSE:["License"],ANY_LICENSE:["Any License"],CC_LICENSE:["Creative Commons only"],CC_LICENSE_PARENT:["Creative Commons"],COMM_LICENSE:["Commercial use allowed"],DERIV_LICENSE:["Modifications allowed"],SS_ON:["SafeSearch on"],ON:["On"],SS_MOD:["SafeSearch moderate"],MOD:["Moderate"],SS_OFF:["SafeSearch off"],OFF:["Off"],RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],SORT_BY:["Sort"],SEARCH_IN:["Search"],ADVANCED_SEARCH:["Advanced Search"]})},"@VERSION@",{requires:["intl"]});
YUI.add("search-photos-page-view",function(e){e.namespace("Views")[this.name]=e.Base.create("search-photos-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.searchId=t.searchId,this.apiParams={},this.searchTerm=t.searchTerm,this.apiFailed=t.apiFailed;var n=this.name.replace(/-/g,"_");return this.appContext.flipper.isFlipped("paft")&&e.config.flickr.paft_metrics_samples&&e.config.flickr.paft_metrics_samples[n]&&(t.paft=!0),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isSearchResults:!0},"filter-bar-neutered-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-photos-collection-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,n,r,i=this.appContext.getViewer(),s;return i.signedIn?r=this.appContext.getModel("person-preferences-models",i.nsid):r=e.Promise.resolve(),this.apiFailed?n=e.Promise.resolve():n=this.appContext.getModel("search-photos-models",this.searchId),s=e.Promise.all([r,n]),s.then(function(n){n[0]&&(t.personPreferencesModel=n[0]),n[1]?(t.searchModel=n[1],t.apiParams=t.searchModel.getValue("apiParams")):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)}),s},buildContainer:function(){var e="",t="",n="",r={apiFailed:!1,noQuery:!1,noMatchesForQuery:!1},i,s,o;return this.apiFailed?(r.apiFailed=!0,s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("photos").getList().length?(e=this.subviews["search-photos-collection-view"].get("container"),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("emptyQuery")?(r.noQuery=!0,s=this.intlMessage({intlName:"search.SEARCH_START"}),i=this.intlMessage({intlName:"search.BY_USER",user:"Gilles Couturier"})):(r.noMatchesForQuery=this.buildNoMatchesFoundMessage(),s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")),o={"global-nav-view":this.subviews["global-nav-view"].get("container"),"filter-bar-neutered-view":t,"search-photos-collection-view":e,searchState:r,searchPlaceholder:s,flippers:this.appContext.flipper.toJSON(),"footer-full-view":n,attribution:{link:"/photos/papy06/11384700923",by:i}},this.setContainerHTML(this.templates("search-photos-page")(o)),this},buildNoMatchesFoundMessage:function(){var t,n,r,i=this.appContext.getViewer();return n=this.searchModel.getValue("apiParams"),n.user_id?i.signedIn&&n.user_id===i.nsid?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR":r="search.NO_MATCHES_FOR_QUERY_TERM_YOUR":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER":r="search.NO_MATCHES_FOR_QUERY_TERM_USER":n.contacts?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS":r="search.NO_MATCHES_FOR_QUERY_TERM_CONTACTS":n.group_id?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP":r="search.NO_MATCHES_FOR_QUERY_TERM_GROUP":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM":r="search.NO_MATCHES_FOR_QUERY",this.searchTerm?t=this.intlMessage({intlName:r,searchTerm:e.flutil.unescape(this.searchTerm)}):t=this.intlMessage({intlName:r}),{noMatchesText:t}},activate:function(){var t=this,n;return this.registerEventHandler(this.subviews["filter-bar-neutered-view"].on("navigating",function(){var e=t.subviews["search-photos-collection-view"];e&&e.displayLoadingIndicator("searching")})),n=this.get("container").one("form.ui-large-search"),n&&this.registerEventHandler(n.on("submit",function(n){delete t.apiParams[e.SearchHelper.API.tags],t.apiParams[e.SearchHelper.API.text]=this.one("input").get("value"),e.SearchHelper.clearAdvancedSearchParams(t.apiParams),e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel),t.appContext.flapp.navigate("/search/?"+e.QueryString.stringify(t.apiParams)),n.preventDefault()})),e.later(100,this,function(){t.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.use("photo-page-scrappy-view"):e.use("photo-page-view")}),this}},{ATTRS:{spaceid:{value:792600534}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-helper","hermes-template-search-photos-page","search-photos-page-css","search-photos-collection-view","display-collection-justified","flickrui-css","footer-full-view","filter-bar-neutered-view","querystring-stringify-simple"],optional:["search-photos-models"],langBundles:["search"]});
YUI.add("hermes-lang-client-app",function(e,t){e.Intl.add("hermes/client-app","en-US",{SAVING_LAST_ACTIONS:["Hey! We\u2019re still saving your last actions, you might lose them if you leave this page."]})},"@VERSION@",{requires:["intl"]});
